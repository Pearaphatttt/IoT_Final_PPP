#include <ESP8266WiFi.h>                          // ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏•‡∏≤‡∏™/‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° Wi-Fi ‡∏ö‡∏ô ESP8266
#include <WiFiClientSecure.h>                     // ‡πÉ‡∏ä‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á client ‡πÅ‡∏ö‡∏ö HTTPS (TLS)
#include <UniversalTelegramBot.h>                 // ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ Telegram Bot (‡∏≠‡∏≤‡∏®‡∏±‡∏¢ ArduinoJson ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô)
#include <DHT.h>                                  // ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå DHT (‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô)

#define DHTPIN D2                                 // ‡∏£‡∏∞‡∏ö‡∏∏‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≠ DATA ‡∏Ç‡∏≠‡∏á DHT ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà D2 (GPIO4)
#define DHTTYPE DHT22                             // ‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏ô‡∏¥‡∏î‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÄ‡∏õ‡πá‡∏ô DHT22 (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô DHT11 ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô)
DHT dht(DHTPIN, DHTTYPE);                         // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏ DHT ‡∏î‡πâ‡∏ß‡∏¢‡∏û‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏ä‡∏ô‡∏¥‡∏î‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î

#define GREEN_LED D6                              // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏û‡∏¥‡∏ô‡πÑ‡∏ü‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (‡πÅ‡∏ó‡∏ô ‚Äú‡∏û‡∏±‡∏î‡∏•‡∏°‚Äù) ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà D6 (GPIO12)
#define RED_LED   D7                              // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏û‡∏¥‡∏ô‡πÑ‡∏ü‡πÅ‡∏î‡∏á (‡πÅ‡∏ó‡∏ô ‚Äú‡∏Æ‡∏µ‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡πå‚Äù) ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà D7 (GPIO13)
#define TRIG_PIN  D0                              // ‡∏û‡∏¥‡∏ô TRIG ‡∏Ç‡∏≠‡∏á‡∏≠‡∏±‡∏•‡∏ï‡∏£‡∏≤‡πÇ‡∏ã‡∏ô‡∏¥‡∏Å ‡πÉ‡∏ä‡πâ D0 (GPIO16) (‡πÄ‡∏õ‡πá‡∏ô output)
#define ECHO_PIN  D1                              // ‡∏û‡∏¥‡∏ô ECHO ‡∏Ç‡∏≠‡∏á‡∏≠‡∏±‡∏•‡∏ï‡∏£‡∏≤‡πÇ‡∏ã‡∏ô‡∏¥‡∏Å ‡πÉ‡∏ä‡πâ D1 (GPIO5) (‡πÄ‡∏õ‡πá‡∏ô input)

// Wi-Fi
const char* ssid     = "P";                       // ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ Wi-Fi ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
const char* password = "pppppppp";                // ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô Wi-Fi

// Telegram
#define BOT_TOKEN "8272302286:AAGDHjg8xaVWAxOSwjo_7DWaJzcLNWGzSgE"        // ‡πÇ‡∏ó‡πÄ‡∏Ñ‡∏ô‡∏ö‡∏≠‡∏ó‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å BotFather 
#define CHAT_ID   "6009634163"                 // Chat ID ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
#define LED       D7                               // ‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå LED (‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ö RED_LED) ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ï‡∏±‡πâ‡∏á MODE

WiFiClientSecure secured_client;                   // ‡∏™‡∏£‡πâ‡∏≤‡∏á client ‡πÅ‡∏ö‡∏ö TLS/SSL ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö Telegram (HTTPS)
UniversalTelegramBot bot(BOT_TOKEN, secured_client); // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡πá‡∏≠‡∏ö‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå‡∏ö‡∏≠‡∏ó ‡∏ú‡∏π‡∏Å‡∏Å‡∏±‡∏ö client ‡πÅ‡∏•‡∏∞ token

// Interval settings
unsigned long lastTimeBotRan = 0;                  // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ ‚Äú‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡πá‡∏Ñ‡∏ö‡∏≠‡∏ó‚Äù (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ)
const unsigned long BOT_MTBS = 1000;               // ‡∏Ñ‡πà‡∏≤‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏≠‡∏ó (ms) (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á)
unsigned long lastSentTime = 0;                    // ‡πÄ‡∏ß‡∏•‡∏≤ ‚Äú‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‚Äù (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á)
const unsigned long SEND_INTERVAL = 10000;         // ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡πâ‡∏≥ (ms) (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á)

float temp;                                        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ (¬∞C)
float humi;                                        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô (%RH)

// --- Variables for Timing and State Control (Add these) ---
unsigned long lastCheckTime = 0;                   // ‡πÄ‡∏ß‡∏•‡∏≤ ‚Äú‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå/‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‚Äù
const unsigned long checkInterval = 5000;          // ‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏∏‡∏Å 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ (ms)

// State flags to prevent spamming alerts
bool isFanOn = false;                               // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‚Äú‡∏û‡∏±‡∏î‡∏•‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏´‡∏°‚Äù (‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡πâ‡∏≥)
bool isHeaterOn = false;                            // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‚Äú‡∏Æ‡∏µ‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏´‡∏°‚Äù
bool tempAlertSent = false;                         // ‡πÄ‡∏Ñ‡∏¢‡∏™‡πà‡∏á ‚Äú‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‚Äù ‡πÑ‡∏õ‡∏£‡∏∂‡∏¢‡∏±‡∏á (‡∏Å‡∏±‡∏ô‡∏™‡πÅ‡∏õ‡∏°)
bool humidityAlertSent = false;                     // ‡πÄ‡∏Ñ‡∏¢‡∏™‡πà‡∏á ‚Äú‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‚Äù ‡πÑ‡∏õ‡∏£‡∏∂‡∏¢‡∏±‡∏á
bool waterAlertSent = false;                        // ‡πÄ‡∏Ñ‡∏¢‡∏™‡πà‡∏á ‚Äú‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏ï‡πà‡∏≥‚Äù ‡πÑ‡∏õ‡∏£‡∏∂‡∏¢‡∏±‡∏á
bool sendingEnabled = true;                         // ‡∏ò‡∏á‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á (‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏à‡∏£‡∏¥‡∏á)
float level_water;                                  // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö ‚Äú‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏î‡πâ‚Äù (cm)
float TankHeight = 40;                              // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏ñ‡∏±‡∏á (cm) ‡∏™‡∏°‡∏°‡∏∏‡∏ï‡∏¥‡∏ß‡πà‡∏≤‡∏à‡∏∏‡∏î‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏´‡∏±‡∏ß‡∏ñ‡∏±‡∏á

float getlevel_water(){                             // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ß‡∏±‡∏î‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏à‡∏≤‡∏Å‡∏≠‡∏±‡∏•‡∏ï‡∏£‡∏≤‡πÇ‡∏ã‡∏ô‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ã‡∏ô‡∏ï‡∏¥‡πÄ‡∏°‡∏ï‡∏£
  digitalWrite(TRIG_PIN, LOW);                      // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå TRIG ‡πÉ‡∏´‡πâ LOW ‡∏™‡∏±‡πâ‡∏ô ‡πÜ (‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏¢‡∏¥‡∏á‡∏û‡∏±‡∏•‡∏™‡πå)
  delayMicroseconds(2);                             // ‡∏´‡∏ô‡πà‡∏ß‡∏á 2 ‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏ï‡∏≤‡∏°‡∏™‡πÄ‡∏õ‡∏Å
  digitalWrite(TRIG_PIN, HIGH);                     // ‡πÉ‡∏´‡πâ TRIG ‡πÄ‡∏õ‡πá‡∏ô HIGH ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏¢‡∏¥‡∏á‡∏Ñ‡∏•‡∏∑‡πà‡∏ô
  delayMicroseconds(10);                            // ‡∏Ñ‡πâ‡∏≤‡∏á HIGH 10 ‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ (‡∏ï‡∏≤‡∏°‡∏™‡πÄ‡∏õ‡∏Å HC-SR04)
  digitalWrite(TRIG_PIN, LOW);                      // ‡∏î‡∏∂‡∏á‡∏Å‡∏•‡∏±‡∏ö LOW ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏ö‡∏û‡∏±‡∏•‡∏™‡πå

  long duration = pulseIn(ECHO_PIN, HIGH);          // ‡∏ß‡∏±‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà ECHO ‡πÄ‡∏õ‡πá‡∏ô HIGH (‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ) ‚Äî *‡πÑ‡∏°‡πà‡∏°‡∏µ timeout*
  float level_water = TankHeight - (duration * 0.034 / 2) ; // ‡∏£‡∏∞‡∏¢‡∏∞ (cm) ‚âà duration*0.034/2 ‚Üí ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥ = ‡∏™‡∏π‡∏á‡∏ñ‡∏±‡∏á ‚àí ‡∏£‡∏∞‡∏¢‡∏∞
  return level_water;                               // ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥ (cm)
}

void setup() {
  Serial.begin(115200);                             // ‡πÄ‡∏õ‡∏¥‡∏î Serial ‡∏ó‡∏µ‡πà 115200 ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏π log/‡∏î‡∏µ‡∏ö‡∏±‡∏Å
  dht.begin();                                      // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô DHT ‡πÉ‡∏´‡πâ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤

  pinMode(RED_LED, OUTPUT);                         // ‡∏ï‡∏±‡πâ‡∏á‡∏û‡∏¥‡∏ô‡πÑ‡∏ü‡πÅ‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏≠‡∏≤‡∏ï‡πå‡∏û‡∏∏‡∏ï
  pinMode(GREEN_LED, OUTPUT);                       // ‡∏ï‡∏±‡πâ‡∏á‡∏û‡∏¥‡∏ô‡πÑ‡∏ü‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏≠‡∏≤‡∏ï‡πå‡∏û‡∏∏‡∏ï
  pinMode(TRIG_PIN, OUTPUT);                        // TRIG ‡∏Ç‡∏≠‡∏á‡∏≠‡∏±‡∏•‡∏ï‡∏£‡∏≤‡πÇ‡∏ã‡∏ô‡∏¥‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏≠‡∏≤‡∏ï‡πå‡∏û‡∏∏‡∏ï
  pinMode(ECHO_PIN, INPUT);                         // ECHO ‡∏Ç‡∏≠‡∏á‡∏≠‡∏±‡∏•‡∏ï‡∏£‡∏≤‡πÇ‡∏ã‡∏ô‡∏¥‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏¥‡∏ô‡∏û‡∏∏‡∏ï (‡∏Ñ‡∏ß‡∏£‡∏•‡∏î‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô 5V‚Üí3.3V)
  pinMode(LED, OUTPUT);                             // ‡∏ï‡∏±‡πâ‡∏á‡∏û‡∏¥‡∏ô LED (D7) ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏≠‡∏≤‡∏ï‡πå‡∏û‡∏∏‡∏ï (‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ö RED_LED ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö)
  digitalWrite(RED_LED, LOW);                       // ‡∏î‡∏±‡∏ö‡πÑ‡∏ü‡πÅ‡∏î‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
  digitalWrite(GREEN_LED, LOW);                     // ‡∏î‡∏±‡∏ö‡πÑ‡∏ü‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô

  WiFi.begin(ssid, password);                       // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ Wi-Fi
  secured_client.setInsecure();                     // ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á TLS (‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏õ‡∏£‡∏î‡∏±‡∏Å‡∏ä‡∏±‡∏ô)

  Serial.print("Connecting WiFi");                  // ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° Wi-Fi
  while (WiFi.status() != WL_CONNECTED) {           // ‡∏•‡∏π‡∏õ‡∏£‡∏≠‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ
    delay(500);                                     // ‡∏´‡∏ô‡πà‡∏ß‡∏á‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
    Serial.print(".");                              // ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏à‡∏∏‡∏î‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤
  }
  Serial.println(" Connected!");                    // ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à

  bot.sendMessage(CHAT_ID, "ESP8266 Bot ready", ""); // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤ Telegram ‡πÅ‡∏à‡πâ‡∏á‡∏ß‡πà‡∏≤ ‚Äú‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‚Äù
  Serial.println("Bot ready!");                     // ‡∏û‡∏¥‡∏°‡∏û‡πå log ‡∏•‡∏á Serial
}

void loop() {

  if (millis() - lastCheckTime > checkInterval) {   // ‡∏ñ‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏£‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡πà‡∏≤‡∏ô/‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• (‡∏ó‡∏∏‡∏Å 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)
    lastCheckTime = millis();                       // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏ß‡∏•‡∏≤ ‚Äú‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‚Äù

    temp = dht.readTemperature();                   // ‡∏≠‡πà‡∏≤‡∏ô‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ (¬∞C) ‡∏à‡∏≤‡∏Å DHT
    humi = dht.readHumidity();                      // ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ó‡∏ò‡πå (%) ‡∏à‡∏≤‡∏Å DHT
    level_water = getlevel_water();                 // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥ (cm) ‡∏à‡∏≤‡∏Å‡∏≠‡∏±‡∏•‡∏ï‡∏£‡∏≤‡πÇ‡∏ã‡∏ô‡∏¥‡∏Å

    if (isnan(humi) || isnan(temp)) {               // ‡∏ñ‡πâ‡∏≤‡∏≠‡πà‡∏≤‡∏ô DHT ‡∏û‡∏•‡∏≤‡∏î (‡πÑ‡∏î‡πâ NaN)
      Serial.println("Failed to read from DHT sensor!"); // ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô Serial
      return;                                       // ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å loop() ‡∏£‡∏≠‡∏ö‡∏ô‡∏µ‡πâ (‡∏Ç‡πâ‡∏≤‡∏°‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á)
    }

    Serial.print("Temp : ");                        // ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡πà‡∏≤ Temp ‡∏•‡∏á Serial
    Serial.println(temp);
    Serial.print("Humi : ");                        // ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡πà‡∏≤ Humi ‡∏•‡∏á Serial
    Serial.println(humi);
    Serial.print("Level Water : ");                 // ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏•‡∏á Serial
    Serial.println(level_water);

    if (temp > 30) {                                // ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô 30¬∞C
      digitalWrite(GREEN_LED, HIGH);                // ‡πÄ‡∏õ‡∏¥‡∏î ‚Äú‡∏û‡∏±‡∏î‡∏•‡∏°‚Äù (‡πÑ‡∏ü‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏ï‡∏¥‡∏î)
      digitalWrite(RED_LED, LOW);                   // ‡∏õ‡∏¥‡∏î ‚Äú‡∏Æ‡∏µ‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡πå‚Äù (‡πÑ‡∏ü‡πÅ‡∏î‡∏á‡∏î‡∏±‡∏ö)
      if (!isFanOn) {                               // ‡∏ñ‡πâ‡∏≤‡∏û‡∏±‡∏î‡∏•‡∏°‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ß‡πà‡∏≤ ON (‡∏Å‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡πâ‡∏≥)
        bot.sendMessage(CHAT_ID, "Alert Temp High!!!! FAN ON(LED GREEN ON)", ""); // ‡∏™‡πà‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
        isFanOn = true;                             // ‡∏ï‡∏±‡πâ‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ß‡πà‡∏≤‡∏û‡∏±‡∏î‡∏•‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß
        isHeaterOn = false;                         // ‡πÅ‡∏•‡∏∞‡∏Æ‡∏µ‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î
      }
    } else if (temp < 25) {                         // ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 25¬∞C
      digitalWrite(RED_LED, HIGH);                  // ‡πÄ‡∏õ‡∏¥‡∏î ‚Äú‡∏Æ‡∏µ‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡πå‚Äù (‡πÑ‡∏ü‡πÅ‡∏î‡∏á‡∏ï‡∏¥‡∏î)
      digitalWrite(GREEN_LED, LOW);                 // ‡∏õ‡∏¥‡∏î ‚Äú‡∏û‡∏±‡∏î‡∏•‡∏°‚Äù (‡πÑ‡∏ü‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏î‡∏±‡∏ö)
      if (!isHeaterOn) {                            // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡πÅ‡∏à‡πâ‡∏á‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏Æ‡∏µ‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡πå
        bot.sendMessage(CHAT_ID, "Alert Temp Low!!!! Heater ON(LED RED ON)", ""); // ‡∏™‡πà‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
        isHeaterOn = true;                          // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Æ‡∏µ‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏õ‡∏¥‡∏î
        isFanOn = false;                            // ‡πÅ‡∏•‡∏∞‡∏û‡∏±‡∏î‡∏•‡∏°‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î
      }
    } else {                                        // ‡∏Å‡∏£‡∏ì‡∏µ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏õ‡∏Å‡∏ï‡∏¥ 25‚Äì30¬∞C
      digitalWrite(RED_LED, LOW);                   // ‡∏î‡∏±‡∏ö‡πÑ‡∏ü‡πÅ‡∏î‡∏á
      digitalWrite(GREEN_LED, LOW);                 // ‡∏î‡∏±‡∏ö‡πÑ‡∏ü‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß
      isFanOn = false;                              // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏û‡∏±‡∏î‡∏•‡∏°
      isHeaterOn = false;                           // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Æ‡∏µ‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡πå
    }

    // 2. ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡πà‡∏≤‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥ (Alerts)
    // ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥
    if (temp < 25 || temp > 30) {                   // ‡∏ñ‡πâ‡∏≤‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏ô‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏õ‡∏Å‡∏ï‡∏¥
      if (!tempAlertSent) {                         // ‡πÅ‡∏•‡∏∞‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏™‡πà‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
        String msg = "‚ö†Ô∏èAlert!!!! TempOutOfRange !!!! "; // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏ö‡∏ö‡∏™‡∏±‡πâ‡∏ô
        bot.sendMessage(CHAT_ID, msg, "");          // ‡∏™‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤ Telegram
        tempAlertSent = true;                       // ‡∏ï‡∏±‡πâ‡∏á‡∏ò‡∏á‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß
      }
    } else {                                        // ‡∏ñ‡πâ‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡πà‡∏ß‡∏á‡∏õ‡∏Å‡∏ï‡∏¥
      tempAlertSent = false;                        // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ò‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏£‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡πâ‡∏≤‡∏´‡∏•‡∏∏‡∏î‡∏ä‡πà‡∏ß‡∏á‡∏≠‡∏µ‡∏Å
    }

    // ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô
    if (humi < 60 || humi > 75) {                   // ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏ô‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á 60‚Äì75%
      if (!humidityAlertSent) {                     // ‡πÅ‡∏•‡∏∞‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏™‡πà‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ô‡∏µ‡πâ
        String msg = "üíß Alert!!!! HumiOutOfRange!!!!!!"; // ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô
        bot.sendMessage(CHAT_ID, msg, "");          // ‡∏™‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤ Telegram
        humidityAlertSent = true;                   // ‡∏ï‡∏±‡πâ‡∏á‡∏ò‡∏á‡∏ß‡πà‡∏≤‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß
      }
    } else {                                        // ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥
      humidityAlertSent = false;                    // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ò‡∏á
    }

    // ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥
    if (level_water < 5 && level_water > 0) {       // ‡∏ñ‡πâ‡∏≤‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 5 cm ‡πÅ‡∏•‡∏∞ >0 (‡∏Å‡∏±‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏û‡∏µ‡πâ‡∏¢‡∏ô)
      if (!waterAlertSent) {                        // ‡πÅ‡∏•‡∏∞‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏™‡πà‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ô‡∏µ‡πâ
        String msg = "üåä Level Water less than 5 CM | level water is  " + String(level_water) + " cm"; // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
        bot.sendMessage(CHAT_ID, msg, "");          // ‡∏™‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤ Telegram
        waterAlertSent = true;                      // ‡∏ï‡∏±‡πâ‡∏á‡∏ò‡∏á‡∏ß‡πà‡∏≤‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß
      }
    } else {                                        // ‡∏ñ‡πâ‡∏≤‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 5 cm ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ 0/‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á
      waterAlertSent = false;                       // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ò‡∏á
    }
  }
}
